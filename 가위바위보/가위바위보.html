<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>가위바위보</title>
    <style>
        #computer {
            width: 142px;
            height: 200px
        }
    </style>
</head>

<body>
    <div id="computer"></div>
    <div>
        <button id="scissors">가위</button>
        <button id="rock">바위</button>
        <button id="paper">보</button>
    </div>
    <div id="score">0</div>

    <script>
        const $computer = document.querySelector("#computer");
        const $scissors = document.querySelector("#scissors");
        const $rock = document.querySelector("#rock");
        const $paper = document.querySelector("#paper");
        const $score = document.querySelector("#score");
        const IMG_URL = './img/rsp1.png';
        $computer.style.background = `url(${IMG_URL}) 0 0`; //세로사이즈 0, 가로사이즈 -220px하면 맨끝 이미지가 나옴  
        $computer.style.backgroundSize = 'auto 200px'; //세로는 div 사이즈 (200px)에 맞추고 가로사이즈는 이미지가 반복되면 안되기에 auto(원본)를 줌 

        //y좌표가 0이라는 공통점이 있음. 세로만 조절함. 객체로 묶는다.
        const rspX = {
            scissors: '0', //가위
            rock: '-220px', //바위
            paper: '-440px', //보
        }

        //일정 시간마다 rsp  반복하기
        let computerChoice = 'scissors'; //값이 계속 바뀌니까 let
        //재귀함수, setTimeout 
        const changeComputerHand = () => {
            if (computerChoice === 'scissors') {
                computerChoice = 'rock';
            } else if (computerChoice === 'rock') {
                computerChoice = 'paper';

            } else if (computerChoice === 'paper') {
                computerChoice = 'scissors';
            }
            $computer.style.background = `url(${IMG_URL}) ${rspX[computerChoice]} 0`;
            $computer.style.backgroundSize = 'auto 200px';
        }
        let intervalId = setInterval(changeComputerHand, 50);
        //setInterval(이동작을, ?초동안 반복해); 
        //변수에 저장하는 이유 ? clear의 반환값으로 들어가야함.
        //타이머 만들 때마다 변수에 저장!

        //clickButton 5번 호출, 1번 인터벌->2번->...-> 5번(5번intervalId저장 )
        //그 다음 버튼을 클릭하면, clear하면 5번만 취소..1-4번 계속 돌아감
        const clickButton = () => {
            clearInterval(intervalId); //C1. 클릭하자마자 실행
            setTimeout(() => { //clear 후 다시 동작하게 
                clearInterval(intervalId); //C2.클릭한지 1초 후 실행
                intervalId = setInterval(changeComputerHand, 50); //1번 저장 후 최종적으로 5번 저장
            }, 1000);
        }
        //디버깅1
        //버튼을 클릭하면 intervalId가 멈추고
        //1초 뒤 다시 settimeout으로 intervalId이 동작함 
        //setTimout은 clear를 안해서 계속 동작.
        //clear 누르고 1초 뒤에  intervalId(0.5초) 마다 실행
        //클릭을 연속으로 5번 클릭하면 클릭 수가 쌓여서 그림이 빠르게 동작함
        //클릭 수가 중복되서 intervalId 동작하느라(1-4번 인터벌 반복) 클릭을 눌러도 멈추지 않음 
        //중복되는 intervalId을 setTimeout의 clearInterval(intervalId);을 통해 제거
        $rock.addEventListener('click', clickButton);
        $scissors.addEventListener('click', clickButton);
        $paper.addEventListener('click', clickButton);
    </script>
</body>

</html>